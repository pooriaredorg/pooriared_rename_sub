name: ğŸ”„ Rename JSON Subscription Links to Base64

on:
  workflow_dispatch:
    inputs:
      sub_url:
        description: 'Ù„ÛŒÙ†Ú© Ø³Ø§Ø¨Ø³Ú©Ø±ÛŒÙ¾Ø´Ù† JSON Ø§ØµÙ„ÛŒ (Ù…Ø«Ù„ Ù„ÛŒÙ†Ú© Clash)'
        required: true
      name_prefix:
        description: 'Ù¾ÛŒØ´ÙˆÙ†Ø¯ Ù†Ø§Ù…â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ (Ù…Ø«Ù„Ø§Ù‹ pooriared. Ø®Ø±ÙˆØ¬ÛŒ: pooriared1ØŒ pooriared2)'
        required: true
        default: 'POORIARED'

jobs:
  rename_and_update:
    runs-on: ubuntu-latest
    
    steps:
      - name: â¬‡ï¸ Checkout code
        uses: actions/checkout@v4

      - name: ğŸ Set up Python 3.x
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: ğŸ“¦ Install dependencies (requests)
        run: pip install requests

      - name: ğŸš€ Run Python Script to Convert and Rename
        run: python rename_sub.py
        env:
          SUB_URL: ${{ github.event.inputs.sub_url }}
          NAME_PREFIX: ${{ github.event.inputs.name_prefix }}

      - name: ğŸ’¾ Commit and push new subscription file
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          # Ù†Ø§Ù… ÙØ§ÛŒÙ„ Ø®Ø±ÙˆØ¬ÛŒ Ø¬Ø¯ÛŒØ¯
          file_pattern: POORIARED_sub.txt 
          commit_message: 'Update POORIARED_sub.txt with renamed Base64 configs'
          branch: main
